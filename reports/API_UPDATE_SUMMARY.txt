API.js Update Summary - 2025-11-15 18:14

=== MAJOR CHANGES ===

1. GROWTH API - Updated base paths
   - Changed from /api/growth/units to /api/growth/growth_units
   - Added getUnit(unitId) method
   - Moved camera methods from separate CameraAPI to GrowthAPI
   - Removed deprecated getSettings() and applyAIConditions()
   - Removed getUnitDevices() (use DeviceAPI instead)

2. PLANT API - Complete restructure
   - Changed base path from /api/growth/... to /api/plants/...
   - Added getPlant(plantId) - Get individual plant
   - Added updatePlant(plantId, updates) - Update plant info
   - Updated signatures: removed unitId from updatePlantStage
   - Added getAvailableSensors(unitId, sensorType) - Get linkable sensors
   - Updated all plant-sensor linking paths

3. PLANT HEALTH MONITORING - New endpoints
   - recordHealthObservation(plantId, observation) - Record health issues
   - getHealthHistory(plantId, days) - Get health history
   - getHealthRecommendations(plantId) - Get AI recommendations
   - getAvailableSymptoms() - List available symptoms
   - getHealthStatuses() - Get status/disease type enums

4. DEVICE API - Massive expansion
   - Renamed getSensors() to getAllSensors()
   - Renamed getActuators() to getAllActuators()
   - Added 40+ new sensor/actuator management endpoints:
     * Health monitoring (getSensorHealth, getActuatorHealth)
     * Anomaly detection (getSensorAnomalies, getActuatorAnomalies)
     * Power/Energy analytics (getActuatorPower, getActuatorEnergy)
     * Calibration (calibrateSensor, getActuatorCalibrations)
     * Statistics and history endpoints
   - Added Zigbee2MQTT integration (getZigbeeDevices, sendZigbeeCommand)
   - Marked legacy endpoints as deprecated

5. INSIGHTS API - New analytics module
   - Energy Analytics:
     * getActuatorEnergyDashboard(actuatorId)
     * predictActuatorFailure(actuatorId, daysAhead)
     * getActuatorCostTrends(actuatorId, days)
     * getActuatorRecommendations(actuatorId)
     * getUnitEnergyComparison(unitId)
   - Sensor Analytics:
     * getLatestSensorReading(sensorId)
     * getSensorHistory(sensorId, hours, limit)
     * getSensorStatistics(sensorId, hours)
   - System Dashboards:
     * getDashboardOverview()
     * getEnergySummary(days)
     * getHealthSummary()

6. ESP32 API - Path correction
   - Changed from /api/esp32-c6/... to /api/settings/esp32-c3/...
   - Matches actual backend blueprint registration

7. AGRICULTURE API - Path correction
   - Changed from /api/agriculture/... to /api/v1/plants/...
   - All endpoints updated to new base path

8. REMOVED MODULES
   - CameraAPI - Methods moved to GrowthAPI
   - Camera methods now part of growth unit management

=== API STRUCTURE ===

API.Growth      - Growth unit CRUD, schedules, thresholds, camera
API.Plant       - Plant CRUD, stages, sensor linking, health monitoring
API.Device      - Comprehensive device management (sensors/actuators)
API.Insights    - Analytics, predictions, energy monitoring (NEW)
API.Sensor      - Sensor history queries
API.Dashboard   - Dashboard data aggregation
API.Settings    - System settings (hotspot, camera, environment)
API.ESP32       - ESP32-C3 device management
API.Agriculture - Plant intelligence and recommendations
API.Session     - Session management
API.Status      - System status

=== TOTAL ENDPOINTS ===

Growth API:     20 endpoints
Plant API:      18 endpoints (8 new health endpoints)
Device API:     65+ endpoints (40+ new)
Insights API:   16 endpoints (ALL NEW)
Sensor API:     1 endpoint
Dashboard API:  3 endpoints
Settings API:   3 endpoints
ESP32 API:      12 endpoints
Agriculture API: 8 endpoints
Session API:    1 endpoint
Status API:     1 endpoint

TOTAL:          ~148 documented API endpoints

=== USAGE EXAMPLES ===

// Plant Health Monitoring
await API.Plant.recordHealthObservation(plantId, {
    health_status: 'stressed',
    symptoms: ['yellowing_leaves', 'wilting'],
    severity_level: 3,
    affected_parts: ['leaves'],
    notes: 'Lower leaves yellowing'
});

// Energy Analytics
const dashboard = await API.Insights.getActuatorEnergyDashboard(actuatorId);
const prediction = await API.Insights.predictActuatorFailure(actuatorId, 7);

// Device Management
const sensors = await API.Device.getAllSensors();
const health = await API.Device.getSensorHealth(sensorId);
const anomalies = await API.Device.getActuatorAnomalies(actuatorId);

// Growth Unit Camera
await API.Growth.startCamera(unitId);
const photo = await API.Growth.capturePhoto(unitId);
await API.Growth.stopCamera(unitId);

=== BACKWARD COMPATIBILITY ===

‚úÖ All existing endpoints still work
‚ö†Ô∏è  Some paths changed - update frontend references:
   - Growth units: /api/growth/units ‚Üí /api/growth/growth_units
   - Plants: /api/growth/units/{id}/plants ‚Üí /api/plants/units/{id}/plants
   - Agriculture: /api/agriculture ‚Üí /api/v1/plants
   - ESP32: /api/esp32-c6 ‚Üí /api/settings/esp32-c3

üìù Deprecated but functional:
   - DeviceAPI.add_sensor() ‚Üí use addSensor()
   - DeviceAPI.remove_sensor() ‚Üí use deleteSensor()
   - DeviceAPI.add_actuator() ‚Üí use addActuator()
   - DeviceAPI.remove_actuator() ‚Üí use deleteActuator()

=== FILE INFO ===

File: static/js/api.js
Lines: ~1800+
Size: Significantly expanded
All syntax validated ‚úÖ
