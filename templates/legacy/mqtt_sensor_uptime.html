{% extends 'base.html' %}
{% import "macros.html" as ui %}

{% block body_class %}dashboard-page{% endblock %}

{% block content %}
<div class="page-shell">
<div class="page-surface" aria-labelledby="mqtt-uptime-heading">
    <div class="dashboard-header">
        <div class="header-content">
            <h1 class="dashboard-title" id="mqtt-uptime-heading">
                <i class="fas fa-wifi"></i>
                MQTT Sensor Uptime
            </h1>
            <p class="dashboard-subtitle">Monitor sensor connectivity and last seen timestamps</p>
        </div>
        <div class="dashboard-status">
            <span class="status-indicator connected">
                <i class="fas fa-heartbeat"></i> Connection Monitor
            </span>
        </div>
    </div>

  <section class="management-section">
    <div class="card-header">
        <h2 class="section-title">Sensor Status</h2>
    </div>

    <div class="card">
      <form class="modern-form" id="refreshForm">
        {{ ui.form_field('refreshInterval', 'Refresh interval (seconds):', type='number', value='30', min=5, max=3600, class_name='form-input') }}
        <button type="submit" class="btn btn-primary">Apply</button>
      </form>
    </div>

    <div id="sensorListContainer" class="table-container" role="region" aria-live="polite" aria-atomic="true">
      <table class="modern-table">
        <thead>
          <tr>
            <th scope="col">Sensor</th>
            <th scope="col">Last Seen</th>
            <th scope="col">Status</th>
          </tr>
        </thead>
        <tbody id="sensorList">
          <tr><td colspan="3">Loading...</td></tr>
        </tbody>
      </table>
    </div>
  </section>
</div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/api.js') }}"></script>
<script type="module">
    import { initMqttSensorUptime } from "{{ url_for('static', filename='js/mqtt_sensor_uptime.js') }}";
    initMqttSensorUptime();
</script>
{% endblock %}
