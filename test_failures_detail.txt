============================= test session starts =============================
collecting ... collected 20 items

tests/test_api.py::test_growth_unit_lifecycle FAILED                     [  5%]
tests/test_api.py::test_sensor_history_endpoint FAILED                   [ 10%]
tests/test_api.py::test_status_endpoint FAILED                           [ 15%]
tests/test_api_devices_v2.py::test_create_sensor_v2_happy_path FAILED    [ 20%]
tests/test_api_devices_v2.py::test_create_sensor_v2_validation_error FAILED [ 25%]
tests/test_api_devices_v2.py::test_create_actuator_v2_happy_path FAILED  [ 30%]
tests/test_api_devices_v2.py::test_create_actuator_v2_validation_error FAILED [ 35%]
tests/test_plant_journal_watering_endpoint.py::test_journal_watering_endpoint_creates_entry FAILED [ 40%]
tests/test_settings_api.py::test_plants_seeded PASSED                    [ 45%]
tests/test_settings_api.py::test_hotspot_settings_roundtrip FAILED       [ 50%]
tests/test_settings_api.py::test_camera_settings_roundtrip FAILED        [ 55%]
tests/test_settings_api.py::test_device_schedule_roundtrip FAILED        [ 60%]
tests/test_settings_api.py::test_environment_thresholds_validation FAILED [ 65%]
tests/test_startup_regressions.py::test_devices_utils_reexports_shared_aliases PASSED [ 70%]
tests/test_startup_regressions.py::test_irrigation_predictor_exports_prediction_confidence PASSED [ 75%]
tests/test_startup_regressions.py::test_api_error_handler_preserves_404_for_unknown_api_route PASSED [ 80%]
tests/test_startup_regressions.py::test_api_error_handler_preserves_405_for_method_not_allowed PASSED [ 85%]
tests/test_startup_regressions.py::test_startup_critical_modules_avoid_datetime_utc_import FAILED [ 90%]
tests/test_dashboard_summary_regressions.py::test_build_devices_summary_counts_active_from_is_active_and_sensors ERROR [ 95%]
tests/test_dashboard_summary_regressions.py::test_dashboard_summary_preserves_actuators_and_passes_them_to_unit_settings ERROR [100%]

=================================== ERRORS ====================================
_ ERROR at setup of test_build_devices_summary_counts_active_from_is_active_and_sensors _
tests\test_dashboard_summary_regressions.py:78: in dashboard_api_module
    spec.loader.exec_module(module)
<frozen importlib._bootstrap_external>:1026: in exec_module
    ???
<frozen importlib._bootstrap>:488: in _call_with_frames_removed
    ???
app\blueprints\api\dashboard.py:24: in <module>
    from app.utils.time import utc_now
E   ImportError: cannot import name 'utc_now' from 'app.utils.time' (unknown location)
_ ERROR at setup of test_dashboard_summary_preserves_actuators_and_passes_them_to_unit_settings _
tests\test_dashboard_summary_regressions.py:78: in dashboard_api_module
    spec.loader.exec_module(module)
<frozen importlib._bootstrap_external>:1026: in exec_module
    ???
<frozen importlib._bootstrap>:488: in _call_with_frames_removed
    ???
app\blueprints\api\dashboard.py:24: in <module>
    from app.utils.time import utc_now
E   ImportError: cannot import name 'utc_now' from 'app.utils.time' (unknown location)
================================== FAILURES ===================================
_________________________ test_growth_unit_lifecycle __________________________
tests\test_api.py:45: in test_growth_unit_lifecycle
    assert response.status_code == 201
E   assert 401 == 201
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:56:50,946 - root - INFO - Logging initialized at level: INFO\n2026-02-19 20:56:50,979 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:56:51,792 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:56:51,794 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:56:51,795 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:56:51,796 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:56:51,796 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:56:51,797 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:56:51,798 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:56:51,798 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:56:51,798 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:56:51,799 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:56:51,800 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:56:51,801 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:56:51,801 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:56:51,802 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:56:51,802 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:56:51,803 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:56:51,803 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:56:51,803 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:56:51,804 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:56:51,805 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:56:51,805 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:56:51,805 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:56:51,806 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E1ED5AC590>\n2026-02-19 20:56:51,808 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E1ED5AC590>\n2026-02-19 20:56:51,809 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:56:51,809 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:56:51,812 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:56:51,812 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:56:51,814 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:56:51,815 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:56:51,817 - root - INFO - EventBus workers started (pool=2 queue=1024)\n2026-02-19 20:56:58,003 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:56:58,003 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:56:58,007 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:56:58,007 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:56:58,007 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:56:58,007 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:56:58,007 - sensor_registry - INFO - Sensor registry initialized\n2026-02-19 20:56:58,007 - sensor_registry - INFO - Registered protocol 'GPIO' with adapter GPIOAdapter\n2026-02-19 20:56:58,008 - sensor_registry - INFO - Registered protocol 'I2C' with adapter GPIOAdapter\n2026-02-19 20:56:58,008 - sensor_registry - INFO - Registered protocol 'ADC' with adapter GPIOAdapter\n2026-02-19 20:56:58,008 - sensor_registry - INFO - Registered protocol 'mqtt' with adapter SYSGrowAdapter\n2026-02-19 20:56:58,008 - sensor_registry - INFO - Registered protocol 'wireless' with adapter SYSGrowAdapter\n2026-02-19 20:56:58,008 - sensor_registry - INFO - Registered protocol 'http' with adapter WiFiAdapter\n2026-02-19 20:56:58,008 - sensor_registry - INFO - Registered protocol 'zigbee' with adapter ZigbeeAdapter\n2026-02-19 20:56:58,008 - sensor_registry - INFO - Registered protocol 'zigbee2mqtt' with adapter Zigbee2MQTTAdapter\n2026-02-19 20:56:58,008 - sensor_registry - INFO - Registered protocol 'Modbus' with adapter ModbusAdapter\n2026-02-19 20:56:58,008 - sensor_registry - INFO - Protocol-based sensor adapters registered\n2026-02-19 20:56:58,013 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:56:58,128 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:56:58,128 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:56:58,128 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:56:58,129 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:56:58,129 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:56:58,129 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:56:58,129 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:56:58,129 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:56:58,129 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:56:58,129 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:56:58,129 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:56:58,129 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:56:58,130 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:56:58,140 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:config.py:725 Logging initialized at level: INFO\nINFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nINFO     root:event_bus.py:79 EventBus workers started (pool=2 queue=1024)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nINFO     sensor_registry:registry.py:35 Sensor registry initialized\nINFO     sensor_registry:registry.py:53 Registered protocol 'GPIO' with adapter GPIOAdapter\nINFO     sensor_registry:registry.py:53 Registered protocol 'I2C' with adapter GPIOAdapter\nINFO     sensor_registry:registry.py:53 Registered protocol 'ADC' with adapter GPIOAdapter\nINFO     sensor_registry:registry.py:53 Registered protocol 'mqtt' with adapter SYSGrowAdapter\nINFO     sensor_registry:registry.py:53 Registered protocol 'wireless' with adapter SYSGrowAdapter\nINFO     sensor_registry:registry.py:53 Registered protocol 'http' with adapter WiFiAdapter\nINFO     sensor_registry:registry.py:53 Registered protocol 'zigbee' with adapter ZigbeeAdapter\nINFO     sensor_registry:registry.py:53 Registered protocol 'zigbee2mqtt' with adapter Zigbee2MQTTAdapter\nINFO     sensor_registry:registry.py:53 Registered protocol 'Modbus' with adapter ModbusAdapter\nINFO     sensor_registry:registry.py:320 Protocol-based sensor adapters registered\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
---------------------------- Captured stdout call -----------------------------
2026-02-19 20:56:58,146 - app.services.application.threshold_service - ERROR - Error fetching unit thresholds for 1: No item with that key
Traceback (most recent call last):
  File "E:\Work\SYSGrow\backend\app\services\application\threshold_service.py", line 361, in get_unit_thresholds
    data = row if isinstance(row, dict) else {k: row[k] for k in row}
                                                 ~~~^^^
IndexError: No item with that key
2026-02-19 20:56:58,149 - growth_api.units - INFO - Listing growth units via endpoint
2026-02-19 20:56:58,151 - app.middleware.api_auth - WARNING - Blocked unauthenticated POST to /api/v1/plants/units/1/plants from 127.0.0.1
------------------------------ Captured log call ------------------------------
ERROR    app.services.application.threshold_service:threshold_service.py:385 Error fetching unit thresholds for 1: No item with that key
Traceback (most recent call last):
  File "E:\Work\SYSGrow\backend\app\services\application\threshold_service.py", line 361, in get_unit_thresholds
    data = row if isinstance(row, dict) else {k: row[k] for k in row}
                                                 ~~~^^^
IndexError: No item with that key
INFO     growth_api.units:units.py:186 Listing growth units via endpoint
WARNING  app.middleware.api_auth:api_auth.py:85 Blocked unauthenticated POST to /api/v1/plants/units/1/plants from 127.0.0.1
________________________ test_sensor_history_endpoint _________________________
tests\test_api.py:137: in test_sensor_history_endpoint
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <WrapperTestResponse streamed [500 INTERNAL SERVER ERROR]>.status_code
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:56:58,392 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:56:58,421 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:56:58,423 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:56:58,424 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:56:58,424 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:56:58,425 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:56:58,425 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:56:58,426 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:56:58,426 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:56:58,426 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:56:58,426 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:56:58,427 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:56:58,428 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:56:58,428 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:56:58,428 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:56:58,428 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:56:58,429 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:56:58,429 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:56:58,429 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:56:58,429 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:56:58,430 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:56:58,431 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:56:58,431 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:56:58,431 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E195CAAD50>\n2026-02-19 20:56:58,432 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E195CAAD50>\n2026-02-19 20:56:58,433 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:56:58,433 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:56:58,434 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:56:58,435 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:56:58,435 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:56:58,437 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:56:58,441 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:03,461 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:57:03,461 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:57:03,461 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:57:03,461 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:57:03,461 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:57:03,461 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:57:03,463 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:03,466 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:57:03,468 - app.workers.unified_scheduler - WARNING - Scheduler already running\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:57:03,577 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:57:03,578 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:57:03,578 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:57:03,578 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:57:03,578 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:57:03,578 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:57:03,578 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:57:03,578 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:57:03,578 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:57:03,578 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:57:03,593 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nWARNING  app.workers.unified_scheduler:unified_scheduler.py:607 Scheduler already running\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
---------------------------- Captured stdout call -----------------------------
2026-02-19 20:57:03,598 - app.utils.http - ERROR - API error [500] Failed to get sensor history: type object 'datetime.datetime' has no attribute 'UTC'
Traceback (most recent call last):
  File "E:\Work\SYSGrow\backend\app\utils\http.py", line 128, in wrapper
    return fn(*args, **kwargs)
  File "E:\Work\SYSGrow\backend\app\blueprints\api\analytics\sensors.py", line 86, in get_sensors_history
    end = _parse_datetime(request.args.get("end"), utc_now())
  File "E:\Work\SYSGrow\backend\app\blueprints\api\_common.py", line 158, in parse_datetime
    return ensure_utc(default)
  File "E:\Work\SYSGrow\backend\app\blueprints\api\_common.py", line 181, in ensure_utc
    return dt.astimezone(datetime.UTC)
                         ^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'UTC'
------------------------------ Captured log call ------------------------------
ERROR    app.utils.http:http.py:50 API error [500] Failed to get sensor history: type object 'datetime.datetime' has no attribute 'UTC'
Traceback (most recent call last):
  File "E:\Work\SYSGrow\backend\app\utils\http.py", line 128, in wrapper
    return fn(*args, **kwargs)
  File "E:\Work\SYSGrow\backend\app\blueprints\api\analytics\sensors.py", line 86, in get_sensors_history
    end = _parse_datetime(request.args.get("end"), utc_now())
  File "E:\Work\SYSGrow\backend\app\blueprints\api\_common.py", line 158, in parse_datetime
    return ensure_utc(default)
  File "E:\Work\SYSGrow\backend\app\blueprints\api\_common.py", line 181, in ensure_utc
    return dt.astimezone(datetime.UTC)
                         ^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'UTC'
____________________________ test_status_endpoint _____________________________
tests\test_api.py:147: in test_status_endpoint
    response = client.get("/status/")
               ^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\werkzeug\test.py:1162: in get
    return self.open(*args, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\flask\testing.py:235: in open
    response = super().open(
.venv\Lib\site-packages\werkzeug\test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\werkzeug\test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\werkzeug\test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\flask\app.py:1536: in __call__
    return self.wsgi_app(environ, start_response)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app\__init__.py:301: in _legacy_api_rewrite
    return _original_wsgi(environ, start_response)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\flask_socketio\__init__.py:42: in __call__
    return super().__call__(environ, start_response)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\engineio\middleware.py:74: in __call__
    return self.wsgi_app(environ, start_response)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\flask\app.py:1514: in wsgi_app
    response = self.handle_exception(e)
               ^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\flask\app.py:1511: in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\flask\app.py:919: in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\flask\app.py:802: in handle_user_exception
    return self.handle_http_exception(e)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\flask\app.py:777: in handle_http_exception
    return self.ensure_sync(handler)(e)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app\__init__.py:208: in _handle_unhandled
    raise exc  # Let Flask's default HTML error pages handle UI routes
    ^^^^^^^^^
.venv\Lib\site-packages\flask\app.py:917: in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\flask\app.py:891: in dispatch_request
    self.raise_routing_exception(req)
.venv\Lib\site-packages\flask\app.py:500: in raise_routing_exception
    raise request.routing_exception  # type: ignore[misc]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\flask\ctx.py:362: in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\werkzeug\routing\map.py:629: in match
    raise NotFound() from None
E   werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:57:03,612 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:57:03,645 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:57:03,646 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:57:03,647 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:57:03,647 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:57:03,648 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:57:03,648 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:57:03,649 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:57:03,649 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:57:03,649 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:57:03,649 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:57:03,650 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:57:03,651 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:57:03,651 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:57:03,652 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:57:03,652 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:57:03,652 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:57:03,652 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:57:03,653 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:57:03,653 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:57:03,654 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:57:03,655 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:57:03,655 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:57:03,656 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E197560B90>\n2026-02-19 20:57:03,657 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E197560B90>\n2026-02-19 20:57:03,657 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:57:03,657 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:57:03,659 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:57:03,659 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:57:03,660 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:57:03,661 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:57:03,666 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:03,666 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:08,679 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:57:08,679 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:57:08,679 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:57:08,679 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:57:08,679 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:57:08,679 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:57:08,680 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:08,680 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:08,682 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:57:08,684 - app.workers.unified_scheduler - WARNING - Scheduler already running\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:57:08,764 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:57:08,765 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:57:08,765 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:57:08,774 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nWARNING  app.workers.unified_scheduler:unified_scheduler.py:607 Scheduler already running\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
______________________ test_create_sensor_v2_happy_path _______________________
tests\test_api_devices_v2.py:43: in test_create_sensor_v2_happy_path
    assert response.status_code == 201
E   assert 401 == 201
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:57:08,850 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:57:08,880 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:57:08,881 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:57:08,882 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:57:08,883 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:57:08,883 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:57:08,883 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:57:08,884 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:57:08,884 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:57:08,884 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:57:08,884 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:57:08,885 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:57:08,886 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:57:08,886 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:57:08,886 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:57:08,887 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:57:08,887 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:57:08,887 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:57:08,888 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:57:08,889 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:57:08,889 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:57:08,890 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:57:08,890 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:57:08,891 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E197929F30>\n2026-02-19 20:57:08,892 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E197929F30>\n2026-02-19 20:57:08,892 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:57:08,892 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:57:08,893 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:57:08,894 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:57:08,895 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:57:08,896 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:57:08,900 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:08,901 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:08,901 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:13,909 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:57:13,909 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:57:13,909 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:57:13,909 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:57:13,910 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:57:13,910 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:57:13,911 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:13,911 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:13,911 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:13,913 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:57:13,915 - app.workers.unified_scheduler - WARNING - Scheduler already running\n2026-02-19 20:57:14,073 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:57:14,073 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:57:14,073 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:57:14,074 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:57:14,075 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:57:14,075 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:57:14,075 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:57:14,075 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:57:14,075 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:57:14,075 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:57:14,075 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:57:14,075 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:57:14,075 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:57:14,075 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:57:14,084 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nWARNING  app.workers.unified_scheduler:unified_scheduler.py:607 Scheduler already running\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
---------------------------- Captured stdout call -----------------------------
2026-02-19 20:57:14,086 - app.services.application.threshold_service - ERROR - Error fetching unit thresholds for 1: No item with that key
Traceback (most recent call last):
  File "E:\Work\SYSGrow\backend\app\services\application\threshold_service.py", line 361, in get_unit_thresholds
    data = row if isinstance(row, dict) else {k: row[k] for k in row}
                                                 ~~~^^^
IndexError: No item with that key
2026-02-19 20:57:14,087 - app.middleware.api_auth - WARNING - Blocked unauthenticated POST to /api/v1/devices/v2/sensors from 127.0.0.1
------------------------------ Captured log call ------------------------------
ERROR    app.services.application.threshold_service:threshold_service.py:385 Error fetching unit thresholds for 1: No item with that key
Traceback (most recent call last):
  File "E:\Work\SYSGrow\backend\app\services\application\threshold_service.py", line 361, in get_unit_thresholds
    data = row if isinstance(row, dict) else {k: row[k] for k in row}
                                                 ~~~^^^
IndexError: No item with that key
WARNING  app.middleware.api_auth:api_auth.py:85 Blocked unauthenticated POST to /api/v1/devices/v2/sensors from 127.0.0.1
___________________ test_create_sensor_v2_validation_error ____________________
tests\test_api_devices_v2.py:57: in test_create_sensor_v2_validation_error
    assert response.status_code == 400
E   assert 401 == 400
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:57:14,094 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:57:14,124 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:57:14,125 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:57:14,126 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:57:14,127 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:57:14,127 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:57:14,127 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:57:14,128 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:57:14,128 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:57:14,128 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:57:14,128 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:57:14,129 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:57:14,130 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:57:14,130 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:57:14,130 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:57:14,131 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:57:14,131 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:57:14,131 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:57:14,131 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:57:14,132 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:57:14,133 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:57:14,133 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:57:14,133 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:57:14,134 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E197990640>\n2026-02-19 20:57:14,135 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E197990640>\n2026-02-19 20:57:14,135 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:57:14,135 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:57:14,136 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:57:14,137 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:57:14,137 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:57:14,139 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:57:14,143 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:14,143 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:14,143 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:14,143 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:19,155 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:57:19,155 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:57:19,155 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:57:19,155 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:57:19,155 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:57:19,155 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:57:19,156 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:19,156 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:19,157 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:19,157 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:19,159 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:57:19,160 - app.workers.unified_scheduler - WARNING - Scheduler already running\n2026-02-19 20:57:19,239 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:57:19,239 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:57:19,239 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:57:19,239 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:57:19,239 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:57:19,239 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:57:19,239 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:57:19,239 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:57:19,239 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:57:19,239 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:57:19,239 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:57:19,240 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:57:19,248 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nWARNING  app.workers.unified_scheduler:unified_scheduler.py:607 Scheduler already running\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
---------------------------- Captured stdout call -----------------------------
2026-02-19 20:57:19,250 - app.middleware.api_auth - WARNING - Blocked unauthenticated POST to /api/v1/devices/v2/sensors from 127.0.0.1
------------------------------ Captured log call ------------------------------
WARNING  app.middleware.api_auth:api_auth.py:85 Blocked unauthenticated POST to /api/v1/devices/v2/sensors from 127.0.0.1
_____________________ test_create_actuator_v2_happy_path ______________________
tests\test_api_devices_v2.py:74: in test_create_actuator_v2_happy_path
    assert response.status_code == 201
E   assert 401 == 201
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:57:19,256 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:57:19,282 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:57:19,283 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:57:19,283 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:57:19,284 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:57:19,284 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:57:19,284 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:57:19,285 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:57:19,285 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:57:19,285 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:57:19,285 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:57:19,286 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:57:19,287 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:57:19,287 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:57:19,288 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:57:19,288 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:57:19,289 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:57:19,289 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:57:19,289 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:57:19,290 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:57:19,291 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:57:19,292 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:57:19,292 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:57:19,292 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E197594CB0>\n2026-02-19 20:57:19,294 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E197594CB0>\n2026-02-19 20:57:19,294 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:57:19,294 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:57:19,295 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:57:19,296 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:57:19,297 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:57:19,298 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:57:19,302 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:19,302 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:19,302 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:19,302 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:19,302 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:24,313 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:57:24,313 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:57:24,314 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:57:24,314 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:57:24,314 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:57:24,314 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:57:24,315 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:24,315 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:24,315 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:24,315 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:24,316 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:24,319 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:57:24,321 - app.workers.unified_scheduler - WARNING - Scheduler already running\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:57:24,401 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:57:24,409 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nWARNING  app.workers.unified_scheduler:unified_scheduler.py:607 Scheduler already running\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
---------------------------- Captured stdout call -----------------------------
2026-02-19 20:57:24,411 - app.services.application.threshold_service - ERROR - Error fetching unit thresholds for 1: No item with that key
Traceback (most recent call last):
  File "E:\Work\SYSGrow\backend\app\services\application\threshold_service.py", line 361, in get_unit_thresholds
    data = row if isinstance(row, dict) else {k: row[k] for k in row}
                                                 ~~~^^^
IndexError: No item with that key
2026-02-19 20:57:24,412 - app.middleware.api_auth - WARNING - Blocked unauthenticated POST to /api/v1/devices/v2/actuators from 127.0.0.1
------------------------------ Captured log call ------------------------------
ERROR    app.services.application.threshold_service:threshold_service.py:385 Error fetching unit thresholds for 1: No item with that key
Traceback (most recent call last):
  File "E:\Work\SYSGrow\backend\app\services\application\threshold_service.py", line 361, in get_unit_thresholds
    data = row if isinstance(row, dict) else {k: row[k] for k in row}
                                                 ~~~^^^
IndexError: No item with that key
WARNING  app.middleware.api_auth:api_auth.py:85 Blocked unauthenticated POST to /api/v1/devices/v2/actuators from 127.0.0.1
__________________ test_create_actuator_v2_validation_error ___________________
tests\test_api_devices_v2.py:88: in test_create_actuator_v2_validation_error
    assert response.status_code == 400
E   assert 401 == 400
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:57:24,419 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:57:24,451 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:57:24,452 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:57:24,453 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:57:24,453 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:57:24,454 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:57:24,454 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:57:24,455 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:57:24,455 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:57:24,455 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:57:24,455 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:57:24,456 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:57:24,457 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:57:24,457 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:57:24,457 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:57:24,458 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:57:24,458 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:57:24,458 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:57:24,458 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:57:24,459 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:57:24,460 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:57:24,460 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:57:24,460 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:57:24,461 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E1ED660C00>\n2026-02-19 20:57:24,461 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E1ED660C00>\n2026-02-19 20:57:24,462 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:57:24,462 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:57:24,463 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:57:24,464 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:57:24,464 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:57:24,465 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:57:24,483 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:24,483 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:24,483 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:24,483 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:24,483 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:24,483 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,499 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:57:29,499 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:57:29,499 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:57:29,499 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:57:29,499 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:57:29,499 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:57:29,500 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,500 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,501 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,501 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,501 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,501 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,504 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:57:29,506 - app.workers.unified_scheduler - WARNING - Scheduler already running\n2026-02-19 20:57:29,587 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:57:29,587 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:57:29,587 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:57:29,588 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:57:29,597 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nWARNING  app.workers.unified_scheduler:unified_scheduler.py:607 Scheduler already running\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
---------------------------- Captured stdout call -----------------------------
2026-02-19 20:57:29,598 - app.middleware.api_auth - WARNING - Blocked unauthenticated POST to /api/v1/devices/v2/actuators from 127.0.0.1
------------------------------ Captured log call ------------------------------
WARNING  app.middleware.api_auth:api_auth.py:85 Blocked unauthenticated POST to /api/v1/devices/v2/actuators from 127.0.0.1
________________ test_journal_watering_endpoint_creates_entry _________________
tests\test_plant_journal_watering_endpoint.py:53: in test_journal_watering_endpoint_creates_entry
    plant_id = _create_plant(client, unit_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests\test_plant_journal_watering_endpoint.py:43: in _create_plant
    assert response.status_code == 201
E   assert 401 == 201
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:57:29,607 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:57:29,634 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:57:29,635 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:57:29,636 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:57:29,637 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:57:29,637 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:57:29,638 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:57:29,638 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:57:29,639 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:57:29,639 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:57:29,639 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:57:29,640 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:57:29,641 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:57:29,641 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:57:29,641 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:57:29,642 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:57:29,642 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:57:29,642 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:57:29,642 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:57:29,643 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:57:29,643 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:57:29,644 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:57:29,644 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:57:29,645 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E195BA2470>\n2026-02-19 20:57:29,646 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E195BA2470>\n2026-02-19 20:57:29,646 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:57:29,646 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:57:29,647 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:57:29,648 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:57:29,649 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:57:29,650 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:57:29,655 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,655 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,655 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,655 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,655 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,656 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:29,656 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:34,672 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:57:34,672 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:57:34,672 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:57:34,672 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:57:34,672 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:57:34,673 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:57:34,674 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:34,674 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:34,674 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:34,674 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:34,674 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:34,675 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:34,675 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:34,677 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:57:34,678 - app.workers.unified_scheduler - WARNING - Scheduler already running\n2026-02-19 20:57:34,758 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:57:34,758 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:57:34,758 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:57:34,758 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:57:34,758 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:57:34,758 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:57:34,758 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:57:34,759 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:57:34,768 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nWARNING  app.workers.unified_scheduler:unified_scheduler.py:607 Scheduler already running\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
---------------------------- Captured stdout call -----------------------------
2026-02-19 20:57:34,770 - app.services.application.threshold_service - ERROR - Error fetching unit thresholds for 1: No item with that key
Traceback (most recent call last):
  File "E:\Work\SYSGrow\backend\app\services\application\threshold_service.py", line 361, in get_unit_thresholds
    data = row if isinstance(row, dict) else {k: row[k] for k in row}
                                                 ~~~^^^
IndexError: No item with that key
2026-02-19 20:57:34,771 - app.middleware.api_auth - WARNING - Blocked unauthenticated POST to /api/v1/plants/units/1/plants from 127.0.0.1
------------------------------ Captured log call ------------------------------
ERROR    app.services.application.threshold_service:threshold_service.py:385 Error fetching unit thresholds for 1: No item with that key
Traceback (most recent call last):
  File "E:\Work\SYSGrow\backend\app\services\application\threshold_service.py", line 361, in get_unit_thresholds
    data = row if isinstance(row, dict) else {k: row[k] for k in row}
                                                 ~~~^^^
IndexError: No item with that key
WARNING  app.middleware.api_auth:api_auth.py:85 Blocked unauthenticated POST to /api/v1/plants/units/1/plants from 127.0.0.1
_______________________ test_hotspot_settings_roundtrip _______________________
tests\test_settings_api.py:50: in test_hotspot_settings_roundtrip
    assert response.status_code == 200
E   assert 401 == 200
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:57:39,946 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:57:39,974 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:57:39,975 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:57:39,976 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:57:39,976 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:57:39,976 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:57:39,977 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:57:39,977 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:57:39,977 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:57:39,977 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:57:39,978 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:57:39,978 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:57:39,979 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:57:39,979 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:57:39,980 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:57:39,980 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:57:39,980 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:57:39,980 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:57:39,980 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:57:39,981 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:57:39,982 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:57:39,982 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:57:39,982 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:57:39,983 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E197437B50>\n2026-02-19 20:57:39,983 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E197437B50>\n2026-02-19 20:57:39,984 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:57:39,984 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:57:39,985 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:57:39,986 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:57:39,986 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:57:39,988 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:57:39,992 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:39,992 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:39,992 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:39,992 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:39,992 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:39,992 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:39,993 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:39,993 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:39,993 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,006 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:57:45,006 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:57:45,006 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:57:45,007 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:57:45,007 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:57:45,007 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:57:45,007 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,008 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,008 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,008 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,008 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,008 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,009 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,009 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,009 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,012 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:57:45,013 - app.workers.unified_scheduler - WARNING - Scheduler already running\n2026-02-19 20:57:45,098 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:57:45,098 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:57:45,098 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:57:45,098 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:57:45,098 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:57:45,098 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:57:45,099 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:57:45,109 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nWARNING  app.workers.unified_scheduler:unified_scheduler.py:607 Scheduler already running\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
---------------------------- Captured stdout call -----------------------------
2026-02-19 20:57:45,111 - app.middleware.api_auth - WARNING - Blocked unauthenticated PUT to /api/v1/settings/hotspot from 127.0.0.1
------------------------------ Captured log call ------------------------------
WARNING  app.middleware.api_auth:api_auth.py:85 Blocked unauthenticated PUT to /api/v1/settings/hotspot from 127.0.0.1
_______________________ test_camera_settings_roundtrip ________________________
tests\test_settings_api.py:87: in test_camera_settings_roundtrip
    assert response.status_code == 200
E   assert 401 == 200
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:57:45,117 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:57:45,145 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:57:45,146 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:57:45,147 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:57:45,147 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:57:45,148 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:57:45,148 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:57:45,148 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:57:45,149 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:57:45,149 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:57:45,149 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:57:45,150 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:57:45,151 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:57:45,151 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:57:45,151 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:57:45,151 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:57:45,152 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:57:45,152 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:57:45,152 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:57:45,152 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:57:45,153 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:57:45,154 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:57:45,154 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:57:45,154 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E199E21D60>\n2026-02-19 20:57:45,155 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E199E21D60>\n2026-02-19 20:57:45,156 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:57:45,156 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:57:45,157 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:57:45,158 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:57:45,158 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:57:45,159 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:57:45,163 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,163 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,163 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,164 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,164 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,164 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,164 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,164 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,164 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:45,165 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,174 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:57:50,174 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:57:50,175 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:57:50,175 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:57:50,175 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:57:50,175 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:57:50,176 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,176 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,176 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,176 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,176 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,176 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,177 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,177 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,177 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,177 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,180 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:57:50,181 - app.workers.unified_scheduler - WARNING - Scheduler already running\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:57:50,267 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:57:50,268 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:57:50,268 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:57:50,268 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:57:50,268 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:57:50,268 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:57:50,268 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:57:50,268 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:57:50,268 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:57:50,388 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nWARNING  app.workers.unified_scheduler:unified_scheduler.py:607 Scheduler already running\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
---------------------------- Captured stdout call -----------------------------
2026-02-19 20:57:50,390 - app.middleware.api_auth - WARNING - Blocked unauthenticated PUT to /api/v1/settings/camera from 127.0.0.1
------------------------------ Captured log call ------------------------------
WARNING  app.middleware.api_auth:api_auth.py:85 Blocked unauthenticated PUT to /api/v1/settings/camera from 127.0.0.1
_______________________ test_device_schedule_roundtrip ________________________
tests\test_settings_api.py:117: in test_device_schedule_roundtrip
    assert response.status_code in (200, 201)
E   assert 401 in (200, 201)
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:57:50,396 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:57:50,424 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:57:50,425 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:57:50,426 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:57:50,426 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:57:50,427 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:57:50,427 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:57:50,428 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:57:50,428 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:57:50,428 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:57:50,428 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:57:50,429 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:57:50,430 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:57:50,430 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:57:50,430 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:57:50,431 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:57:50,431 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:57:50,431 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:57:50,431 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:57:50,432 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:57:50,432 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:57:50,433 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:57:50,433 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:57:50,434 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E19A263A70>\n2026-02-19 20:57:50,434 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E19A263A70>\n2026-02-19 20:57:50,435 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:57:50,435 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:57:50,436 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:57:50,437 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:57:50,437 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:57:50,439 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:57:50,443 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,443 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,443 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,443 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,443 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,443 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,444 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,444 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,444 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,444 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:50,444 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,452 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:57:55,452 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:57:55,452 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:57:55,452 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:57:55,453 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:57:55,453 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:57:55,454 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,454 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,454 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,455 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,455 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,455 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,455 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,455 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,455 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,456 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,456 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,460 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:57:55,462 - app.workers.unified_scheduler - WARNING - Scheduler already running\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:57:55,595 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:57:55,596 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:57:55,596 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:57:55,596 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:57:55,596 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:57:55,596 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:57:55,596 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:57:55,596 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:57:55,596 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:57:55,596 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:57:55,613 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nWARNING  app.workers.unified_scheduler:unified_scheduler.py:607 Scheduler already running\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
---------------------------- Captured stdout call -----------------------------
2026-02-19 20:57:55,616 - app.middleware.api_auth - WARNING - Blocked unauthenticated POST to /api/v1/growth/v3/units/1/schedules from 127.0.0.1
------------------------------ Captured log call ------------------------------
WARNING  app.middleware.api_auth:api_auth.py:85 Blocked unauthenticated POST to /api/v1/growth/v3/units/1/schedules from 127.0.0.1
___________________ test_environment_thresholds_validation ____________________
tests\test_settings_api.py:141: in test_environment_thresholds_validation
    assert bad_response.status_code == 200
E   assert 401 == 200
E    +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
---------------------------- Captured stdout setup ----------------------------
2026-02-19 20:57:55,625 - root - INFO - \u2705 Socket.IO initialized with CORS origins: *\n2026-02-19 20:57:55,665 - root - INFO - Seeded DeviceEnergyProfiles table with 16 default profiles.\n2026-02-19 20:57:55,666 - root - INFO - Seeded Plants table with 15 catalog entries.\n2026-02-19 20:57:55,667 - migration_mod - INFO - Migration 28 (irrigation_ml_context) completed successfully\n2026-02-19 20:57:55,668 - migration_mod - INFO - \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\n2026-02-19 20:57:55,668 - migration_mod - INFO - \u2713 Created DiseaseOccurrence table\n2026-02-19 20:57:55,668 - migration_mod - INFO - \u2713 Created DiseasePredictionFeedback table\n2026-02-19 20:57:55,669 - migration_mod - INFO - \u2713 Created disease tracking indexes\n2026-02-19 20:57:55,669 - migration_mod - INFO - \u2705 Migration 30 (disease_tracking) completed successfully\n2026-02-19 20:57:55,669 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\n2026-02-19 20:57:55,670 - migration_mod - INFO - Adding light_mode column to GrowthUnits...\n2026-02-19 20:57:55,670 - migration_mod - INFO - \u2713 Added light_mode column to GrowthUnits\n2026-02-19 20:57:55,672 - migration_mod - INFO - Added column aqi_threshold_override to Plants\n2026-02-19 20:57:55,672 - migration_mod - INFO - \u2713 Migration add_plant_threshold_overrides completed successfully\n2026-02-19 20:57:55,672 - migration_mod - INFO - \u2713 Migration add_plant_actuators completed successfully\n2026-02-19 20:57:55,673 - migration_mod - INFO - \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\n2026-02-19 20:57:55,673 - migration_mod - INFO - Column air_quality_threshold already exists in GrowthUnits\n2026-02-19 20:57:55,673 - migration_mod - INFO - Column air_quality_threshold_override already exists in Plants\n2026-02-19 20:57:55,673 - migration_mod - INFO - Old column co2_ppm not found in PlantReadings, adding co2\n2026-02-19 20:57:55,674 - migration_mod - INFO - Old column voc_ppb not found in PlantReadings, adding voc\n2026-02-19 20:57:55,675 - migration_mod - INFO - Old column aqi not found in PlantReadings, adding air_quality\n2026-02-19 20:57:55,675 - migration_mod - INFO - Old column co2_ppm not found in MLTrainingData, adding co2\n2026-02-19 20:57:55,675 - migration_mod - ERROR - Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\n2026-02-19 20:57:55,676 - infrastructure.database.sqlite_handler - ERROR - \u274c Migration 034_standardize_sensor_columns.py failed\nRunning migration 051 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E1998C19B0>\n2026-02-19 20:57:55,677 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nRunning migration 052 on <infrastructure.database.sqlite_handler.SQLiteDatabaseHandler object at 0x000001E1998C19B0>\n2026-02-19 20:57:55,677 - infrastructure.database.sqlite_handler - ERROR - Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\n2026-02-19 20:57:55,677 - migration_mod - INFO - Migration 53 (irrigation_reliability_tables) completed successfully\n2026-02-19 20:57:55,678 - migration_mod - INFO - Adding 'lux' column to PlantReadings table\n2026-02-19 20:57:55,679 - migration_mod - INFO - \u2713 Migration add_lux_to_plant_readings completed successfully\n2026-02-19 20:57:55,680 - migration_mod - INFO - \u2713 Migration add_ph_ec_to_plant_readings completed successfully\n2026-02-19 20:57:55,681 - migration_mod - INFO - \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\n2026-02-19 20:57:55,685 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,685 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,685 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,685 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,685 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,686 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,686 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,686 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,686 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,686 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,687 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:57:55,687 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,700 - app.services.ai.model_registry - WARNING - No production version set for plant_health_regressor\n2026-02-19 20:58:00,700 - app.services.ai.model_registry - WARNING - No production version set for plant_health_classifier\n2026-02-19 20:58:00,700 - app.services.ai.model_registry - WARNING - No production version set for irrigation_threshold\n2026-02-19 20:58:00,700 - app.services.ai.model_registry - WARNING - No production version set for irrigation_response\n2026-02-19 20:58:00,700 - app.services.ai.model_registry - WARNING - No production version set for irrigation_duration\n2026-02-19 20:58:00,700 - app.services.ai.model_registry - WARNING - No production version set for irrigation_timing\n2026-02-19 20:58:00,701 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,701 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,701 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,701 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,702 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,702 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,702 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,702 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,702 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,702 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,702 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,702 - app.services.hardware.mqtt_sensor_service - ERROR - Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\n2026-02-19 20:58:00,708 - activity_log - INFO - [INFO] system_startup: Smart Agriculture System started\n2026-02-19 20:58:00,709 - app.workers.unified_scheduler - WARNING - Scheduler already running\n2026-02-19 20:58:00,787 - root - INFO -  Registered blueprint: auth\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ui\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: plants_api\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: disease\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: settings_api\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: growth_api\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: devices_api\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: dashboard_api\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: harvest\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_base\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_predictions\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_models\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_monitoring\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_analytics\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_retraining\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_analysis\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_readiness\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_ab_testing\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_continuous\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_personalized\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: ml_training_data\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: health_api\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: help_api\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: blog_api\n2026-02-19 20:58:00,788 - root - INFO -  Registered blueprint: docs_api\n2026-02-19 20:58:00,797 - root - INFO - Skipping hardware bootstrap (bootstrap_runtime=False)
----------------------------- Captured log setup ------------------------------
INFO     root:extensions.py:80 \u2705 Socket.IO initialized with CORS origins: *\nINFO     root:sqlite_handler.py:1652 Seeded DeviceEnergyProfiles table with 16 default profiles.\nINFO     root:sqlite_handler.py:1615 Seeded Plants table with 15 catalog entries.\nINFO     migration_mod:028_irrigation_ml_context.py:97 Migration 28 (irrigation_ml_context) completed successfully\nINFO     migration_mod:029_bayesian_threshold_columns.py:57 \u2705 Migration 029 (bayesian_threshold_columns) completed successfully\nINFO     migration_mod:029_disease_tracking.py:80 \u2713 Created DiseaseOccurrence table\nINFO     migration_mod:029_disease_tracking.py:119 \u2713 Created DiseasePredictionFeedback table\nINFO     migration_mod:029_disease_tracking.py:134 \u2713 Created disease tracking indexes\nINFO     migration_mod:029_disease_tracking.py:137 \u2705 Migration 30 (disease_tracking) completed successfully\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 029_disease_tracking.py: UNIQUE constraint failed: Migrations.migration_id\nINFO     migration_mod:030_add_light_mode_column.py:44 Adding light_mode column to GrowthUnits...\nINFO     migration_mod:030_add_light_mode_column.py:49 \u2713 Added light_mode column to GrowthUnits\nINFO     migration_mod:031_add_plant_threshold_overrides.py:44 Added column aqi_threshold_override to Plants\nINFO     migration_mod:031_add_plant_threshold_overrides.py:47 \u2713 Migration add_plant_threshold_overrides completed successfully\nINFO     migration_mod:032_add_plant_actuators.py:39 \u2713 Migration add_plant_actuators completed successfully\nINFO     migration_mod:033_rename_light_intensity_threshold_to_lux_threshold.py:79 \u2713 Migration rename_light_intensity_threshold_to_lux_threshold completed successfully\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold already exists in GrowthUnits\nINFO     migration_mod:034_standardize_sensor_columns.py:41 Column air_quality_threshold_override already exists in Plants\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in PlantReadings, adding co2\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column voc_ppb not found in PlantReadings, adding voc\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column aqi not found in PlantReadings, adding air_quality\nINFO     migration_mod:034_standardize_sensor_columns.py:45 Old column co2_ppm not found in MLTrainingData, adding co2\nERROR    migration_mod:034_standardize_sensor_columns.py:93 Migration standardize_sensor_columns failed: no such table: MLTrainingData\nTraceback (most recent call last):\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 82, in migrate\n    _rename_or_copy(cursor, "MLTrainingData", old_name="co2_ppm", new_name="co2", column_type="REAL")\n    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "E:\\Work\\SYSGrow\\backend\\infrastructure\\database\\migrations\\034_standardize_sensor_columns.py", line 46, in _rename_or_copy\n    cursor.execute(\n    ~~~~~~~~~~~~~~^\n        f"ALTER TABLE {table} ADD COLUMN {new_name} {column_type} {default_clause}"\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\nsqlite3.OperationalError: no such table: MLTrainingData\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:107 \u274c Migration 034_standardize_sensor_columns.py failed\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 051_add_actuator_config_unique_index.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nERROR    infrastructure.database.sqlite_handler:sqlite_handler.py:109 Failed to run migration 052_add_recovery_codes.py: expected str, bytes or os.PathLike object, not SQLiteDatabaseHandler\nINFO     migration_mod:053_irrigation_reliability_tables.py:185 Migration 53 (irrigation_reliability_tables) completed successfully\nINFO     migration_mod:057_add_lux_to_plant_readings.py:31 Adding 'lux' column to PlantReadings table\nINFO     migration_mod:057_add_lux_to_plant_readings.py:35 \u2713 Migration add_lux_to_plant_readings completed successfully\nINFO     migration_mod:059_add_ph_ec_to_plant_readings.py:36 \u2713 Migration add_ph_ec_to_plant_readings completed successfully\nINFO     migration_mod:060_backfill_plant_soil_moisture_overrides.py:81 \u2713 Migration backfill_plant_soil_moisture_overrides completed successfully (15 plants updated)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (state): Expecting value: line 1 column 1 (char 0)\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_regressor\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for plant_health_classifier\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_threshold\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_response\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_duration\nWARNING  app.services.ai.model_registry:model_registry.py:371 No production version set for irrigation_timing\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nERROR    app.services.hardware.mqtt_sensor_service:mqtt_sensor_service.py:679 Invalid JSON from zigbee2mqtt (devices): Expecting value: line 1 column 1 (char 0)\nINFO     activity_log:activity_logger.py:128 [INFO] system_startup: Smart Agriculture System started\nWARNING  app.workers.unified_scheduler:unified_scheduler.py:607 Scheduler already running\nINFO     root:__init__.py:283  Registered blueprint: auth\nINFO     root:__init__.py:283  Registered blueprint: ui\nINFO     root:__init__.py:283  Registered blueprint: plants_api\nINFO     root:__init__.py:283  Registered blueprint: disease\nINFO     root:__init__.py:283  Registered blueprint: settings_api\nINFO     root:__init__.py:283  Registered blueprint: growth_api\nINFO     root:__init__.py:283  Registered blueprint: devices_api\nINFO     root:__init__.py:283  Registered blueprint: dashboard_api\nINFO     root:__init__.py:283  Registered blueprint: harvest\nINFO     root:__init__.py:283  Registered blueprint: ml_base\nINFO     root:__init__.py:283  Registered blueprint: ml_predictions\nINFO     root:__init__.py:283  Registered blueprint: ml_models\nINFO     root:__init__.py:283  Registered blueprint: ml_monitoring\nINFO     root:__init__.py:283  Registered blueprint: ml_analytics\nINFO     root:__init__.py:283  Registered blueprint: ml_retraining\nINFO     root:__init__.py:283  Registered blueprint: ml_analysis\nINFO     root:__init__.py:283  Registered blueprint: ml_readiness\nINFO     root:__init__.py:283  Registered blueprint: ml_ab_testing\nINFO     root:__init__.py:283  Registered blueprint: ml_continuous\nINFO     root:__init__.py:283  Registered blueprint: ml_personalized\nINFO     root:__init__.py:283  Registered blueprint: ml_training_data\nINFO     root:__init__.py:283  Registered blueprint: health_api\nINFO     root:__init__.py:283  Registered blueprint: help_api\nINFO     root:__init__.py:283  Registered blueprint: blog_api\nINFO     root:__init__.py:283  Registered blueprint: docs_api\nINFO     root:__init__.py:308 Skipping hardware bootstrap (bootstrap_runtime=False)
---------------------------- Captured stdout call -----------------------------
2026-02-19 20:58:00,799 - app.middleware.api_auth - WARNING - Blocked unauthenticated PUT to /api/v1/settings/environment from 127.0.0.1
------------------------------ Captured log call ------------------------------
WARNING  app.middleware.api_auth:api_auth.py:85 Blocked unauthenticated PUT to /api/v1/settings/environment from 127.0.0.1
___________ test_startup_critical_modules_avoid_datetime_utc_import ___________
tests\test_startup_regressions.py:125: in test_startup_critical_modules_avoid_datetime_utc_import
    assert "from datetime import UTC" not in source
E   assert 'from datetime import UTC' not in '"""Utility functions for time handling.\n\nAll timestamps should be UTC and timezone-aware. Persist UTC timestamps as\nISO-8601 strings with timezone offsets (e.g., "+00:00") via iso_now().\n"""\n\nfrom __future__ import annotations\n\nfrom datetime import UTC, datetime\nfrom typing import Any\n\n\ndef utc_now() -> datetime:\n    """Return current UTC time as an aware datetime."""\n    return datetime.now(UTC)\n\n\ndef iso_now(*, timespec: str | None = None) -> str:\n    """Return current UTC time as an ISO8601 string (timezone-aware)."""\n    now = utc_now()\n    if timespec:\n        return now.isoformat(timespec=timespec)\n    return now.isoformat()\n\n\ndef get_current_utc_time() -> datetime:\n    """Backward-compatible alias for retrieving UTC now."""\n    return utc_now()\n\n\ndef convert_utc_to_local(utc_dt: datetime) -> datetime:\n    """Convert a UTC datetime (aware or naive) to the local timezone."""\n    if utc_dt.tzinfo is None:\n        utc_dt = utc_dt.replace(tzinfo=UTC)\n    return utc_dt.astimezone()\n\n\ndef format_datetime(dt: datetime, fmt: str = "%Y-%m-%d %H:%M:%S %Z") -> str:\n    """Format a datetime into a string based on the given format."""\n    return dt.strftime(fmt)\n\n\ndef sqlite_timestamp(dt: datetime) -> str:\n    """Format a datetime for safe use with SQLite datetime() comparisons."""\n    if dt.tzinfo is None:\n        dt = dt.replace(tzinfo=UTC)\n    else:\n        dt = dt.astimezone(UTC)\n    return dt.strftime("%Y-%m-%d %H:%M:%S")\n\n\ndef coerce_datetime(value: Any) -> datetime | None:\n    """\n    Coerce value to datetime, returning None on failure.\n\n    Args:\n        value: String or datetime to coerce\n\n    Returns:\n        Datetime in UTC or None if invalid\n    """\n    if value is None:\n        return None\n\n    if isinstance(value, datetime):\n        parsed = value\n    elif isinstance(value, str):\n        raw = value.strip()\n        if raw.endswith("Z"):\n            raw = raw.replace("Z", "+00:00")\n        try:\n            parsed = datetime.fromisoformat(raw)\n        except ValueError:\n            return None\n    else:\n        return None\n\n    if parsed.tzinfo is not None:\n        parsed = parsed.astimezone(UTC)\n    else:\n        parsed = parsed.replace(tzinfo=UTC)\n\n    return parsed\n'
E
E     'from datetime import UTC' is contained here:
E       """Utility functions for time handling.
E
E       All timestamps should be UTC and timezone-aware. Persist UTC timestamps as
E       ISO-8601 strings with timezone offsets (e.g., "+00:00") via iso_now().
E       """
E
E       from __future__ import annotations
E
E       from datetime import UTC, datetime
E       from typing import Any
E
E
E       def utc_now() -> datetime:
E           """Return current UTC time as an aware datetime."""
E           return datetime.now(UTC)
E
E
E       def iso_now(*, timespec: str | None = None) -> str:
E           """Return current UTC time as an ISO8601 string (timezone-aware)."""
E           now = utc_now()
E           if timespec:
E               return now.isoformat(timespec=timespec)
E           return now.isoformat()
E
E
E       def get_current_utc_time() -> datetime:
E           """Backward-compatible alias for retrieving UTC now."""
E           return utc_now()
E
E
E       def convert_utc_to_local(utc_dt: datetime) -> datetime:
E           """Convert a UTC datetime (aware or naive) to the local timezone."""
E           if utc_dt.tzinfo is None:
E               utc_dt = utc_dt.replace(tzinfo=UTC)
E           return utc_dt.astimezone()
E
E
E       def format_datetime(dt: datetime, fmt: str = "%Y-%m-%d %H:%M:%S %Z") -> str:
E           """Format a datetime into a string based on the given format."""
E           return dt.strftime(fmt)
E
E
E       def sqlite_timestamp(dt: datetime) -> str:
E           """Format a datetime for safe use with SQLite datetime() comparisons."""
E           if dt.tzinfo is None:
E               dt = dt.replace(tzinfo=UTC)
E           else:
E               dt = dt.astimezone(UTC)
E           return dt.strftime("%Y-%m-%d %H:%M:%S")
E
E
E       def coerce_datetime(value: Any) -> datetime | None:
E           """
E           Coerce value to datetime, returning None on failure.
E
E           Args:
E               value: String or datetime to coerce
E
E           Returns:
E               Datetime in UTC or None if invalid
E           """
E           if value is None:
E               return None
E
E           if isinstance(value, datetime):
E               parsed = value
E           elif isinstance(value, str):
E               raw = value.strip()
E               if raw.endswith("Z"):
E                   raw = raw.replace("Z", "+00:00")
E               try:
E                   parsed = datetime.fromisoformat(raw)
E               except ValueError:
E                   return None
E           else:
E               return None
E
E           if parsed.tzinfo is not None:
E               parsed = parsed.astimezone(UTC)
E           else:
E               parsed = parsed.replace(tzinfo=UTC)
E
E           return parsed
============================== warnings summary ===============================
tests/test_api.py: 3 warnings
tests/test_api_devices_v2.py: 4 warnings
tests/test_plant_journal_watering_endpoint.py: 1 warning
tests/test_settings_api.py: 5 warnings
  E:\Work\SYSGrow\backend\app\hardware\mqtt\client_factory.py:48: DeprecationWarning: Callback API version 1 is deprecated, update to latest version
    return mqtt.Client(**client_kwargs)

tests/test_api.py::test_sensor_history_endpoint
  E:\Work\SYSGrow\backend\tests\test_api.py:74: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_api.py::test_growth_unit_lifecycle - assert 401 == 201
 +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
FAILED tests/test_api.py::test_sensor_history_endpoint - assert 500 == 200
 +  where 500 = <WrapperTestResponse streamed [500 INTERNAL SERVER ERROR]>.status_code
FAILED tests/test_api.py::test_status_endpoint - werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
FAILED tests/test_api_devices_v2.py::test_create_sensor_v2_happy_path - assert 401 == 201
 +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
FAILED tests/test_api_devices_v2.py::test_create_sensor_v2_validation_error - assert 401 == 400
 +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
FAILED tests/test_api_devices_v2.py::test_create_actuator_v2_happy_path - assert 401 == 201
 +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
FAILED tests/test_api_devices_v2.py::test_create_actuator_v2_validation_error - assert 401 == 400
 +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
FAILED tests/test_plant_journal_watering_endpoint.py::test_journal_watering_endpoint_creates_entry - assert 401 == 201
 +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
FAILED tests/test_settings_api.py::test_hotspot_settings_roundtrip - assert 401 == 200
 +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
FAILED tests/test_settings_api.py::test_camera_settings_roundtrip - assert 401 == 200
 +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
FAILED tests/test_settings_api.py::test_device_schedule_roundtrip - assert 401 in (200, 201)
 +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
FAILED tests/test_settings_api.py::test_environment_thresholds_validation - assert 401 == 200
 +  where 401 = <WrapperTestResponse streamed [401 UNAUTHORIZED]>.status_code
FAILED tests/test_startup_regressions.py::test_startup_critical_modules_avoid_datetime_utc_import - assert 'from datetime import UTC' not in '"""Utility functions for time handling.\n\nAll timestamps should be UTC and timezone-aware. Persist UTC timestamps as\nISO-8601 strings with timezone offsets (e.g., "+00:00") via iso_now().\n"""\n\nfrom __future__ import annotations\n\nfrom datetime import UTC, datetime\nfrom typing import Any\n\n\ndef utc_now() -> datetime:\n    """Return current UTC time as an aware datetime."""\n    return datetime.now(UTC)\n\n\ndef iso_now(*, timespec: str | None = None) -> str:\n    """Return current UTC time as an ISO8601 string (timezone-aware)."""\n    now = utc_now()\n    if timespec:\n        return now.isoformat(timespec=timespec)\n    return now.isoformat()\n\n\ndef get_current_utc_time() -> datetime:\n    """Backward-compatible alias for retrieving UTC now."""\n    return utc_now()\n\n\ndef convert_utc_to_local(utc_dt: datetime) -> datetime:\n    """Convert a UTC datetime (aware or naive) to the local timezone."""\n    if utc_dt.tzinfo is None:\n        utc_dt = utc_dt.replace(tzinfo=UTC)\n    return utc_dt.astimezone()\n\n\ndef format_datetime(dt: datetime, fmt: str = "%Y-%m-%d %H:%M:%S %Z") -> str:\n    """Format a datetime into a string based on the given format."""\n    return dt.strftime(fmt)\n\n\ndef sqlite_timestamp(dt: datetime) -> str:\n    """Format a datetime for safe use with SQLite datetime() comparisons."""\n    if dt.tzinfo is None:\n        dt = dt.replace(tzinfo=UTC)\n    else:\n        dt = dt.astimezone(UTC)\n    return dt.strftime("%Y-%m-%d %H:%M:%S")\n\n\ndef coerce_datetime(value: Any) -> datetime | None:\n    """\n    Coerce value to datetime, returning None on failure.\n\n    Args:\n        value: String or datetime to coerce\n\n    Returns:\n        Datetime in UTC or None if invalid\n    """\n    if value is None:\n        return None\n\n    if isinstance(value, datetime):\n        parsed = value\n    elif isinstance(value, str):\n        raw = value.strip()\n        if raw.endswith("Z"):\n            raw = raw.replace("Z", "+00:00")\n        try:\n            parsed = datetime.fromisoformat(raw)\n        except ValueError:\n            return None\n    else:\n        return None\n\n    if parsed.tzinfo is not None:\n        parsed = parsed.astimezone(UTC)\n    else:\n        parsed = parsed.replace(tzinfo=UTC)\n\n    return parsed\n'

  'from datetime import UTC' is contained here:
    """Utility functions for time handling.

    All timestamps should be UTC and timezone-aware. Persist UTC timestamps as
    ISO-8601 strings with timezone offsets (e.g., "+00:00") via iso_now().
    """

    from __future__ import annotations

    from datetime import UTC, datetime
    from typing import Any


    def utc_now() -> datetime:
        """Return current UTC time as an aware datetime."""
        return datetime.now(UTC)


    def iso_now(*, timespec: str | None = None) -> str:
        """Return current UTC time as an ISO8601 string (timezone-aware)."""
        now = utc_now()
        if timespec:
            return now.isoformat(timespec=timespec)
        return now.isoformat()


    def get_current_utc_time() -> datetime:
        """Backward-compatible alias for retrieving UTC now."""
        return utc_now()


    def convert_utc_to_local(utc_dt: datetime) -> datetime:
        """Convert a UTC datetime (aware or naive) to the local timezone."""
        if utc_dt.tzinfo is None:
            utc_dt = utc_dt.replace(tzinfo=UTC)
        return utc_dt.astimezone()


    def format_datetime(dt: datetime, fmt: str = "%Y-%m-%d %H:%M:%S %Z") -> str:
        """Format a datetime into a string based on the given format."""
        return dt.strftime(fmt)


    def sqlite_timestamp(dt: datetime) -> str:
        """Format a datetime for safe use with SQLite datetime() comparisons."""
        if dt.tzinfo is None:
            dt = dt.replace(tzinfo=UTC)
        else:
            dt = dt.astimezone(UTC)
        return dt.strftime("%Y-%m-%d %H:%M:%S")


    def coerce_datetime(value: Any) -> datetime | None:
        """
        Coerce value to datetime, returning None on failure.

        Args:
            value: String or datetime to coerce

        Returns:
            Datetime in UTC or None if invalid
        """
        if value is None:
            return None

        if isinstance(value, datetime):
            parsed = value
        elif isinstance(value, str):
            raw = value.strip()
            if raw.endswith("Z"):
                raw = raw.replace("Z", "+00:00")
            try:
                parsed = datetime.fromisoformat(raw)
            except ValueError:
                return None
        else:
            return None

        if parsed.tzinfo is not None:
            parsed = parsed.astimezone(UTC)
        else:
            parsed = parsed.replace(tzinfo=UTC)

        return parsed
ERROR tests/test_dashboard_summary_regressions.py::test_build_devices_summary_counts_active_from_is_active_and_sensors - ImportError: cannot import name 'utc_now' from 'app.utils.time' (unknown location)
ERROR tests/test_dashboard_summary_regressions.py::test_dashboard_summary_preserves_actuators_and_passes_them_to_unit_settings - ImportError: cannot import name 'utc_now' from 'app.utils.time' (unknown location)
======= 13 failed, 5 passed, 14 warnings, 2 errors in 91.41s (0:01:31) ========
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 125, in _graceful_shutdown
    logging.info("Graceful shutdown initiated (%s)", reason)
Message: 'Graceful shutdown initiated (%s)'
Arguments: ('atexit',)
--- Logging error ---
Traceback (most recent call last):
  File "C:\Python313\Lib\logging\__init__.py", line 1153, in emit
    stream.write(msg + self.terminator)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
ValueError: I/O operation on closed file.
Call stack:
  File "E:\Work\SYSGrow\backend\app\__init__.py", line 127, in _graceful_shutdown
    container.shutdown()
  File "E:\Work\SYSGrow\backend\app\services\container.py", line 167, in shutdown
    self.activity_logger.log_activity(
  File "E:\Work\SYSGrow\backend\app\services\application\activity_logger.py", line 128, in log_activity
    activity_file_logger.info(log_message)
Message: '[INFO] system_shutdown: Smart Agriculture System shutting down'
Arguments: ()
Exception ignored in atexit callback <function cleanup_numbered_dir at 0x000001E1E6A3B4C0>:
Traceback (most recent call last):
  File "E:\Work\SYSGrow\backend\.venv\Lib\site-packages\_pytest\pathlib.py", line 374, in cleanup_numbered_dir
    cleanup_dead_symlinks(root)
  File "E:\Work\SYSGrow\backend\.venv\Lib\site-packages\_pytest\pathlib.py", line 359, in cleanup_dead_symlinks
    if not left_dir.resolve().exists():
  File "C:\Python313\Lib\pathlib\_abc.py", line 450, in exists
    self.stat(follow_symlinks=follow_symlinks)
  File "C:\Python313\Lib\pathlib\_local.py", line 515, in stat
    return os.stat(self, follow_symlinks=follow_symlinks)
PermissionError: [WinError 5] Access is denied: 'C:\\Users\\soyse.TIBURON\\AppData\\Local\\Temp\\pytest-of-Seba\\pytest-current'
